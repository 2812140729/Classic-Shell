<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html dir="ltr" lang="en-gb">

<!-- Mirrored from www.classicshell.net/forum/viewtopic.php?f=22&t=6568&view=print by HTTrack Website Copier/3.x [XR&CO'2014], Fri, 08 Jun 2018 04:57:16 GMT -->
<!-- Added by HTTrack --><meta http-equiv="content-type" content="text/html;charset=UTF-8" /><!-- /Added by HTTrack -->
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta http-equiv="Content-Style-Type" content="text/css">
<meta http-equiv="Content-Language" content="en-gb">
<meta name="robots" content="noindex" />
<title>Classic Shell :: View topic - Tools to prevent modification of the MBR?</title>

<style type="text/css">
<!--

body {
	font-family: Verdana,serif;
	font-size: 10pt;
}

img {
	border: 0;
}

td {
	font-family: Verdana,serif;
	font-size: 10pt;
	line-height: 150%;
}

.code, .codecontent, 
.quote, .quotecontent {
	margin: 0 5px 0 5px;
	padding: 5px;
	font-size: smaller;
	border: black solid 1px;
}

.quotetitle {
	color: black;
	display : block;
	font-weight: bold;
}

.forum {
	font-family: Arial,Helvetica,sans-serif;
	font-weight: bold;
	font-size: 18pt;
}

.topic {
	font-family: Arial,Helvetica,sans-serif;
	font-size: 14pt;
	font-weight: bold;
}

.gensmall {
	font-size: 8pt;
}

hr {
	color: #888;
	height: 3px;
	border-style: solid;
}

hr.sep {
	color: #aaa;
	height: 1px;
	border-style: dashed;
}
//-->
</style>

</head>
<body>

<table width="85%" cellspacing="3" cellpadding="0" border="0" align="center">
<tr>
	<td colspan="2" align="center"><span class="Forum">Classic Shell</span><br /><span class="gensmall"><a href="index.html">http://www.classicshell.net/forum/</a></span></td>
</tr>
<tr>
	<td colspan="2"><br /></td>
</tr>
<tr>
	<td><span class="topic">Tools to prevent modification of the MBR?</span><br /><span class="gensmall"><a href="viewtopic0f30.html?f=22&amp;t=6568">http://www.classicshell.net/forum/viewtopic.php?f=22&amp;t=6568</a></span></td>
	<td align="right" valign="bottom"><span class="gensmall">Page <strong>1</strong> of <strong>1</strong></span></td>
</tr>
</table>



	<hr width="85%" />

	<table width="85%" cellspacing="3" cellpadding="0" border="0" align="center">
	<tr>
		<td width="10%" nowrap="nowrap">Author:&nbsp;</td>
		<td><b>thor.a</b> [ Wed Aug 17, 2016 8:32 am ]</td>
	</tr>
	<tr>
		<td width="10%" nowrap="nowrap">Post subject:&nbsp;</td>
		<td><b>Tools to prevent modification of the MBR?</b></td>
	</tr>
	<tr>
		<td colspan="2"><hr class="sep" />Hello,<br /><br />I got the retro virus, too. But not via a ClassicShell-Download on fosshub, but via a SMplayer download on the same day at fosshub, too. I should have seen that there was something wrong with the file: It had just 35 kB (compared to about 35 MB as normal).<br /><br />The restore process of my computer was much, much harder than the usual ways which are currently known because I run a laptop with a special SSD/HDD combination which is seen as one drive (from Lenovo, called RapidDrive). I finally restored the disk combination successfully (yesterday) after several days of research by using a very special Windows Rescue Environment which &quot;knew&quot; about this SSD/HDD by means of an already injected driver. <br /><br />But that's not the point. What I am still thinking about is: How could I prevent such a damage in future? Of course, I could check the file sizes, or I could check the correct certificates. But that's not enough. On 8/3/2016 I was tired and still sitting in front of my laptop trying to find a good video player which have no problems to play a special video format. Of course I had not in my mind that I could get some malicious malware when I downloaded the well known player SMplayer. Of course I installed it ASAP without even noticing the elevation window. This is mainly an automatic process when it is near midnight and I know the software before.<br /><br />So, there is some other mechanism needed. Some guard in the background, some piece of software which checks that there is something wrong with a malware program like this. It's not normal for a program to modify a MBR... Normally, one thinks of antivirus software at this point. Surely it would be interesting if those antivirus tools would have been prevented the infection of the MBR. Did anybody of the victims had such a tool? (I had no antivirus tool in the background running.) <br /><br />And beside the antivirus tools like Kasperski etc. exist some other tools which claim to detect malware with the help of heuristic means. (I like this concept). I found one of those tools some months ago (Anti-Exploit from malwarebytes.com), but I didn't have time yet to test it.<br /><br />Nevertheless it's difficult to prepare a test environment for these tools because normally one's lacking the right piece of malware (should be very young and dangerous!). If I had a copy of the infected smplayer left on my computer I would have taken it and test it with these tools in a virtual machine. But unfortunately I deleted the malware immediately after installing (because it had no function at all...) with Shift-Delete and installed some other video players immediately afterwards. There is nothing left on my harddisk from this retro virus, I checked double with some rescue software like Recuva. No chance.<br /><br />So, if anybody still owns a copy of this malware it would be nice if he could test those tools in a virtual machine wether they prevent the destroying of the MBR. Of course I would be a voluntary, too.<br /><br />Thorsten

		

		</td>
	</tr>
	</table>


	<hr width="85%" />

	<table width="85%" cellspacing="3" cellpadding="0" border="0" align="center">
	<tr>
		<td width="10%" nowrap="nowrap">Author:&nbsp;</td>
		<td><b>Ivo</b> [ Wed Aug 17, 2016 8:56 am ]</td>
	</tr>
	<tr>
		<td width="10%" nowrap="nowrap">Post subject:&nbsp;</td>
		<td><b>Re: Tools to prevent modification of the MBR?</b></td>
	</tr>
	<tr>
		<td colspan="2"><hr class="sep" />You can find an infected copy of Classic Shell here: <!-- m --><a class="postlink" href="http://www.mediafire.com/error.php?errno=320&amp;origin=download">http://www.mediafire.com/download/n7gti ... fected.exe</a><!-- m --><br /><br /><span style="color:#FF0000;"><strong>Notice to everybody: Do not download this file unless you know exactly what you are doing! This file contains malware, not Classic Shell. It is here only so you can find ways to defeat such malware in the future by experimenting in safe isolated environment like a virtual machine.</strong></span>

		

		</td>
	</tr>
	</table>


	<hr width="85%" />

	<table width="85%" cellspacing="3" cellpadding="0" border="0" align="center">
	<tr>
		<td width="10%" nowrap="nowrap">Author:&nbsp;</td>
		<td><b>thor.a</b> [ Wed Aug 17, 2016 9:32 am ]</td>
	</tr>
	<tr>
		<td width="10%" nowrap="nowrap">Post subject:&nbsp;</td>
		<td><b>Re: Tools to prevent modification of the MBR?</b></td>
	</tr>
	<tr>
		<td colspan="2"><hr class="sep" />This link is not valid anymore. (Probably it's better...)<br /><br />Any suggestions concerning my question on how to prevent against such attacks?

		

		</td>
	</tr>
	</table>


	<hr width="85%" />

	<table width="85%" cellspacing="3" cellpadding="0" border="0" align="center">
	<tr>
		<td width="10%" nowrap="nowrap">Author:&nbsp;</td>
		<td><b>Ivo</b> [ Wed Aug 17, 2016 9:39 am ]</td>
	</tr>
	<tr>
		<td width="10%" nowrap="nowrap">Post subject:&nbsp;</td>
		<td><b>Re: Tools to prevent modification of the MBR?</b></td>
	</tr>
	<tr>
		<td colspan="2"><hr class="sep" />The link is valid, but probably your browser rejects it because it is infected. When I have time I'll try to zip the file or find other way to work around the blocks.<br /><br />The only advice I can give you is to always check the digital signature and don't accept UAC prompts with unknown publisher. That's what UAC is for. If you accept, then the program runs as admin and owns your machine. Even if AV software can detect tinkering with the MBR, there is no way to know if it is legitimate or not.

		

		</td>
	</tr>
	</table>


	<hr width="85%" />

	<table width="85%" cellspacing="3" cellpadding="0" border="0" align="center">
	<tr>
		<td width="10%" nowrap="nowrap">Author:&nbsp;</td>
		<td><b>thor.a</b> [ Wed Aug 17, 2016 10:21 am ]</td>
	</tr>
	<tr>
		<td width="10%" nowrap="nowrap">Post subject:&nbsp;</td>
		<td><b>Re: Tools to prevent modification of the MBR?</b></td>
	</tr>
	<tr>
		<td colspan="2"><hr class="sep" /><div class="quotetitle">Ivo wrote:</div><div class="quotecontent">The link is valid, but probably your browser rejects it because it is infected.</div><br />I think I would notice if Chrome blocks something. But Mediafire says: <br />&quot;File Blocked for Violation. The file you requested has been blocked for a violation of ourTerms of Service.&quot;<br /><br />Ok, I will observe the elevation window with more concentration. But many (good) software tools have not certificates at all. E.g. SMplayer... So this method would not have been helped.<br /><br />Thorsten

		

		</td>
	</tr>
	</table>


	<hr width="85%" />

	<table width="85%" cellspacing="3" cellpadding="0" border="0" align="center">
	<tr>
		<td width="10%" nowrap="nowrap">Author:&nbsp;</td>
		<td><b>Gaurav</b> [ Wed Aug 17, 2016 10:56 am ]</td>
	</tr>
	<tr>
		<td width="10%" nowrap="nowrap">Post subject:&nbsp;</td>
		<td><b>Re: Tools to prevent modification of the MBR?</b></td>
	</tr>
	<tr>
		<td colspan="2"><hr class="sep" />You can open Local Security Policy (secpol.msc) -&gt; Local Policy -&gt; Security Options. Enable the setting: &quot;User Account Control: Only elevate executables that are signed and validated&quot;. Once enabled, only signed EXEs are allowed by Windows to elevate. Others will fail with the error message: &quot;A referral was returned from the server.&quot;<br /><br />This will provide you with pretty good security as no app besides the ones that are either digitally signed will be able to run on your PC. Without admin privileges, the damage that malware can cause is limited.<br /><br />This method is not without its flaws. Many useful apps are not signed so you will be unable to run those which require admin permissions. Some programs like file copy utilities or shell extensions need to self-elevate and cannot be run manually or from the command line. You will not be able to run such rare programs but the tradeoff is that your Windows system will be highly secure.<br /><br />You can run such unsigned apps that require admin permissions using Windows Task Scheduler: <!-- m --><a class="postlink" href="http://winaero.com/blog/open-any-program-as-administrator-without-uac-prompt/">http://winaero.com/blog/open-any-progra ... ac-prompt/</a><!-- m -->

		

		</td>
	</tr>
	</table>


	<hr width="85%" />

	<table width="85%" cellspacing="3" cellpadding="0" border="0" align="center">
	<tr>
		<td width="10%" nowrap="nowrap">Author:&nbsp;</td>
		<td><b>thor.a</b> [ Wed Aug 17, 2016 11:39 am ]</td>
	</tr>
	<tr>
		<td width="10%" nowrap="nowrap">Post subject:&nbsp;</td>
		<td><b>Re: Tools to prevent modification of the MBR?</b></td>
	</tr>
	<tr>
		<td colspan="2"><hr class="sep" /><div class="quotetitle">Gaurav wrote:</div><div class="quotecontent">You can open Local Security Policy (secpol.msc) -&gt; Local Policy -&gt; Security Options. Enable the setting: &quot;User Account Control: Only elevate executables that are signed and validated&quot;. Once enabled, only signed EXEs are allowed by Windows to elevate. Others will fail with the error message: &quot;A referral was returned from the server.&quot;<br /><br />This will provide you with pretty good security as no app besides the ones that are either digitally signed will be able to run on your PC. Without admin privileges, the damage that malware can cause is limited.<br /><br />This method is not without its flaws. Many useful apps are not signed so you will be unable to run those which require admin permissions. Some programs like file copy utilities or shell extensions need to self-elevate and cannot be run manually or from the command line. You will not be able to run such rare programs but the tradeoff is that your Windows system will be highly secure.<br /><br />You can run such unsigned apps that require admin permissions using Windows Task Scheduler: <!-- m --><a class="postlink" href="http://winaero.com/blog/open-any-program-as-administrator-without-uac-prompt/">http://winaero.com/blog/open-any-progra ... ac-prompt/</a><!-- m --></div><br />Thanks for the hint. I could imagine to enable this setting on my productive systems. The drawbacks are perhaps fewer than the advantage of being relative safe. <br /><br />Thorsten

		

		</td>
	</tr>
	</table>


<hr width="85%" />

<table width="85%" cellspacing="3" cellpadding="0" border="0" align="center">
<tr>
	<td><span class="gensmall">Page <strong>1</strong> of <strong>1</strong></span></td>
	<td align="right"><span class="gensmall">All times are UTC - 8 hours [ <abbr title="Daylight Saving Time">DST</abbr> ]</span></td>
</tr>
<tr>
	<td colspan="2" align="center"><span class="gensmall">Powered by phpBB&reg; Forum Software &copy; phpBB Group<br />https://www.phpbb.com/</span></td>
</tr>
</table>

</body>

<!-- Mirrored from www.classicshell.net/forum/viewtopic.php?f=22&t=6568&view=print by HTTrack Website Copier/3.x [XR&CO'2014], Fri, 08 Jun 2018 04:57:16 GMT -->
</html>