<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html dir="ltr" lang="en-gb">

<!-- Mirrored from www.classicshell.net/forum/viewtopic.php?f=12&t=5954&start=50&view=print by HTTrack Website Copier/3.x [XR&CO'2014], Fri, 08 Jun 2018 05:12:43 GMT -->
<!-- Added by HTTrack --><meta http-equiv="content-type" content="text/html;charset=UTF-8" /><!-- /Added by HTTrack -->
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta http-equiv="Content-Style-Type" content="text/css">
<meta http-equiv="Content-Language" content="en-gb">
<meta name="robots" content="noindex" />
<title>Classic Shell :: View topic - Classic Shell Start Menu causes explorer lock up</title>

<style type="text/css">
<!--

body {
	font-family: Verdana,serif;
	font-size: 10pt;
}

img {
	border: 0;
}

td {
	font-family: Verdana,serif;
	font-size: 10pt;
	line-height: 150%;
}

.code, .codecontent, 
.quote, .quotecontent {
	margin: 0 5px 0 5px;
	padding: 5px;
	font-size: smaller;
	border: black solid 1px;
}

.quotetitle {
	color: black;
	display : block;
	font-weight: bold;
}

.forum {
	font-family: Arial,Helvetica,sans-serif;
	font-weight: bold;
	font-size: 18pt;
}

.topic {
	font-family: Arial,Helvetica,sans-serif;
	font-size: 14pt;
	font-weight: bold;
}

.gensmall {
	font-size: 8pt;
}

hr {
	color: #888;
	height: 3px;
	border-style: solid;
}

hr.sep {
	color: #aaa;
	height: 1px;
	border-style: dashed;
}
//-->
</style>

</head>
<body>

<table width="85%" cellspacing="3" cellpadding="0" border="0" align="center">
<tr>
	<td colspan="2" align="center"><span class="Forum">Classic Shell</span><br /><span class="gensmall"><a href="index.html">http://www.classicshell.net/forum/</a></span></td>
</tr>
<tr>
	<td colspan="2"><br /></td>
</tr>
<tr>
	<td><span class="topic">Classic Shell Start Menu causes explorer lock up</span><br /><span class="gensmall"><a href="viewtopic81c9.html?f=12&amp;t=5954">http://www.classicshell.net/forum/viewtopic.php?f=12&amp;t=5954</a></span></td>
	<td align="right" valign="bottom"><span class="gensmall">Page <strong>2</strong> of <strong>2</strong></span></td>
</tr>
</table>



	<hr width="85%" />

	<table width="85%" cellspacing="3" cellpadding="0" border="0" align="center">
	<tr>
		<td width="10%" nowrap="nowrap">Author:&nbsp;</td>
		<td><b>ChrisRobb</b> [ Wed Sep 27, 2017 6:31 am ]</td>
	</tr>
	<tr>
		<td width="10%" nowrap="nowrap">Post subject:&nbsp;</td>
		<td><b>Re: Classic Shell Start Menu causes explorer lock up</b></td>
	</tr>
	<tr>
		<td colspan="2"><hr class="sep" />I've been having the issue with several Windows 10 1607 / CS 4.3.0 clients, updated to Windows 10 1703 / CS 4.3.1 and still have the same problem. <br />I would really like to get to the bottom of this issue, I've got a user that's UI is locking up every 30 minutes or so. <br /><br />If you let me know what tools you want me to use to capture crash dumps or logs let me know all I'll get straight on it.

		

		</td>
	</tr>
	</table>


	<hr width="85%" />

	<table width="85%" cellspacing="3" cellpadding="0" border="0" align="center">
	<tr>
		<td width="10%" nowrap="nowrap">Author:&nbsp;</td>
		<td><b>Gaurav</b> [ Wed Sep 27, 2017 7:07 am ]</td>
	</tr>
	<tr>
		<td width="10%" nowrap="nowrap">Post subject:&nbsp;</td>
		<td><b>Re: Classic Shell Start Menu causes explorer lock up</b></td>
	</tr>
	<tr>
		<td colspan="2"><hr class="sep" />How to capture crash dumps or slowdown dumps: <!-- l --><a class="postlink-local" href="viewtopiccc99.html?f=12&amp;t=6">viewtopic.php?f=12&amp;t=6</a><!-- l --> There are different ways so if one doesn't work, try the alternative method.

		

		</td>
	</tr>
	</table>


	<hr width="85%" />

	<table width="85%" cellspacing="3" cellpadding="0" border="0" align="center">
	<tr>
		<td width="10%" nowrap="nowrap">Author:&nbsp;</td>
		<td><b>ChrisRobb</b> [ Wed Sep 27, 2017 7:33 am ]</td>
	</tr>
	<tr>
		<td width="10%" nowrap="nowrap">Post subject:&nbsp;</td>
		<td><b>Re: Classic Shell Start Menu causes explorer lock up</b></td>
	</tr>
	<tr>
		<td colspan="2"><hr class="sep" />I've uploaded the crash dumps from my machine to the MediaFire link in the above article, not sure if it will help though as these weren't captured when the freeze occurs.<br /><br />Explorer didn't crash because of the thread issue though. That occurs randomly and is near impossible to re-create.<br /><br />I've set up the Process Monitor on one of my clients having the issue and I am capturing all events for the Explorer.exe process and will upload the logs when it freezes up.

		

		</td>
	</tr>
	</table>


	<hr width="85%" />

	<table width="85%" cellspacing="3" cellpadding="0" border="0" align="center">
	<tr>
		<td width="10%" nowrap="nowrap">Author:&nbsp;</td>
		<td><b>Ivo</b> [ Wed Sep 27, 2017 9:15 am ]</td>
	</tr>
	<tr>
		<td width="10%" nowrap="nowrap">Post subject:&nbsp;</td>
		<td><b>Re: Classic Shell Start Menu causes explorer lock up</b></td>
	</tr>
	<tr>
		<td colspan="2"><hr class="sep" />I don't see anything obvious in the dumps. The Classic Shell code is not doing anything at this time. There is some COM activity trying to communicate with another process, probably the UWP brokers.<br />I'm not saying Classic Shell is not the root cause, but at the time of the dump there is no evidence of that.

		

		</td>
	</tr>
	</table>


	<hr width="85%" />

	<table width="85%" cellspacing="3" cellpadding="0" border="0" align="center">
	<tr>
		<td width="10%" nowrap="nowrap">Author:&nbsp;</td>
		<td><b>ChrisRobb</b> [ Wed Sep 27, 2017 11:15 pm ]</td>
	</tr>
	<tr>
		<td width="10%" nowrap="nowrap">Post subject:&nbsp;</td>
		<td><b>Re: Classic Shell Start Menu causes explorer lock up</b></td>
	</tr>
	<tr>
		<td colspan="2"><hr class="sep" />Computer crashed again last night, captured all explorer events throughout the day up until the crash (2.8M Events if you want to know) I'll trawl through them and get rid of the gumf and upload the rest.

		

		</td>
	</tr>
	</table>


	<hr width="85%" />

	<table width="85%" cellspacing="3" cellpadding="0" border="0" align="center">
	<tr>
		<td width="10%" nowrap="nowrap">Author:&nbsp;</td>
		<td><b>ChrisRobb</b> [ Thu Sep 28, 2017 4:18 am ]</td>
	</tr>
	<tr>
		<td width="10%" nowrap="nowrap">Post subject:&nbsp;</td>
		<td><b>Re: Classic Shell Start Menu causes explorer lock up</b></td>
	</tr>
	<tr>
		<td colspan="2"><hr class="sep" />I've uploaded the logs from Process Monitor around the time of the crash.<br />Hopefully something sticks out.<br />Is it worth me running the ProcDump tool when Explorer is crashed?

		

		</td>
	</tr>
	</table>


	<hr width="85%" />

	<table width="85%" cellspacing="3" cellpadding="0" border="0" align="center">
	<tr>
		<td width="10%" nowrap="nowrap">Author:&nbsp;</td>
		<td><b>Ivo</b> [ Thu Sep 28, 2017 9:43 am ]</td>
	</tr>
	<tr>
		<td width="10%" nowrap="nowrap">Post subject:&nbsp;</td>
		<td><b>Re: Classic Shell Start Menu causes explorer lock up</b></td>
	</tr>
	<tr>
		<td colspan="2"><hr class="sep" />I think running ProcDump after the fact will not work. If you want to save dump automatically without running ProcDump constantly, you need to use the registry method. The link is at the top of this page.

		

		</td>
	</tr>
	</table>


	<hr width="85%" />

	<table width="85%" cellspacing="3" cellpadding="0" border="0" align="center">
	<tr>
		<td width="10%" nowrap="nowrap">Author:&nbsp;</td>
		<td><b>JPVJ</b> [ Tue Oct 17, 2017 12:23 pm ]</td>
	</tr>
	<tr>
		<td width="10%" nowrap="nowrap">Post subject:&nbsp;</td>
		<td><b>Re: Classic Shell Start Menu causes explorer lock up</b></td>
	</tr>
	<tr>
		<td colspan="2"><hr class="sep" />Anybody had a chance to test CS 4.3.1 with Windows 10 Fall Creators Update (released today)?

		

		</td>
	</tr>
	</table>


	<hr width="85%" />

	<table width="85%" cellspacing="3" cellpadding="0" border="0" align="center">
	<tr>
		<td width="10%" nowrap="nowrap">Author:&nbsp;</td>
		<td><b>Jcee</b> [ Tue Oct 17, 2017 3:50 pm ]</td>
	</tr>
	<tr>
		<td width="10%" nowrap="nowrap">Post subject:&nbsp;</td>
		<td><b>Re: Classic Shell Start Menu causes explorer lock up</b></td>
	</tr>
	<tr>
		<td colspan="2"><hr class="sep" />No extensive testing Version 1709; but initially it seems to work for me; without needing to reinstall (it will prompt to 'reconfigure' classic shell)

		

		</td>
	</tr>
	</table>


	<hr width="85%" />

	<table width="85%" cellspacing="3" cellpadding="0" border="0" align="center">
	<tr>
		<td width="10%" nowrap="nowrap">Author:&nbsp;</td>
		<td><b>nilknarf69</b> [ Wed Nov 15, 2017 7:26 am ]</td>
	</tr>
	<tr>
		<td width="10%" nowrap="nowrap">Post subject:&nbsp;</td>
		<td><b>Re: Classic Shell Start Menu causes explorer lock up</b></td>
	</tr>
	<tr>
		<td colspan="2"><hr class="sep" />After much testing I found that the problem would on occasion show itself on non-domain machines, so there being something in a GPO causing it had to be unfortunately ruled out. Still no idea what the common thread is for the people that see it every now and then, but I'd rather explorer lock up occasionally than use the default Windows 10 start menu, and that sentiment is shared by the people that get the lockups (sorry Microsoft, you did a bad job there!).

		

		</td>
	</tr>
	</table>


	<hr width="85%" />

	<table width="85%" cellspacing="3" cellpadding="0" border="0" align="center">
	<tr>
		<td width="10%" nowrap="nowrap">Author:&nbsp;</td>
		<td><b>JohnnyMartins</b> [ Mon Nov 20, 2017 9:49 am ]</td>
	</tr>
	<tr>
		<td width="10%" nowrap="nowrap">Post subject:&nbsp;</td>
		<td><b>Re: Classic Shell Start Menu causes explorer lock up</b></td>
	</tr>
	<tr>
		<td colspan="2"><hr class="sep" />I'm also having this issue occasionally.<br />Currently still on Windows 10 1703.<br /><br />The thing is I've noticed that frequently threads on the explorer.exe start to acumulate on waiting status until eventually the explorer process just locks up and crashes when enough &quot;stuck&quot; threads have accumulated.<br /><br /><br />Now, the thread that is common to all these ones that are stuck in waiting mode, is a thread belonging to ClassicStartMenu with a &quot;Start address&quot; reported sometimes as &quot;ClassicStartMenuDLL.dll!DllExecuteNamedCommand&quot;, other times reported as &quot;ClassicStartMenuDLL.dll!WaitDllInitThread&quot;, by Sysinternals Process Explorer.<br /><br />I hope this helps in any way.

		

		</td>
	</tr>
	</table>


	<hr width="85%" />

	<table width="85%" cellspacing="3" cellpadding="0" border="0" align="center">
	<tr>
		<td width="10%" nowrap="nowrap">Author:&nbsp;</td>
		<td><b>Ivo</b> [ Fri Nov 24, 2017 12:24 pm ]</td>
	</tr>
	<tr>
		<td width="10%" nowrap="nowrap">Post subject:&nbsp;</td>
		<td><b>Re: Classic Shell Start Menu causes explorer lock up</b></td>
	</tr>
	<tr>
		<td colspan="2"><hr class="sep" />So far the most reliable way to reproduce the issue has been to install some software. At some point during installation the threads in Explorer start piling up. There must be some weird interaction between Classic Shell, Explorer, and MSI.<br />I spent few days trying to track it down, but as of yet I have no good leads.

		

		</td>
	</tr>
	</table>


	<hr width="85%" />

	<table width="85%" cellspacing="3" cellpadding="0" border="0" align="center">
	<tr>
		<td width="10%" nowrap="nowrap">Author:&nbsp;</td>
		<td><b>JohnnyMartins</b> [ Fri Nov 24, 2017 1:44 pm ]</td>
	</tr>
	<tr>
		<td width="10%" nowrap="nowrap">Post subject:&nbsp;</td>
		<td><b>Re: Classic Shell Start Menu causes explorer lock up</b></td>
	</tr>
	<tr>
		<td colspan="2"><hr class="sep" />I've been able to reproduce the problem with some consistency, of explorer.exe accumulating waiting threads (which over time permanently increase the explorer.exe process memory usage and usually lead to the explorer crash) just by opening many explorer based windows (File Explorer, Control Panel, Devices and Printers, Default Programs, etc...) and then closing them.<br />In fact I've notested that the pile of stuck threads increases much more when closing the windows than when opening them.<br /><br />By surprise of mine, I think I found a workaround.<br />I changed the File Explorer setting to &quot;Launch folder windows in a separate process&quot;.<br />The end result is 2 explorer.exe processes running, but now I can open and close dozens of explorer based windows and both processes remain working normally with no waiting threads within both explorer processes.<br />And also both explorer.exe processes remain low on memory usage only increasing when the number windows increase and shrinking when I close the windows.<br /><br />Now, I remember trying this exact same solution many months ago but it did not work out in the end like it did now.<br />So my guess is some change in the latest classicshell version makes this solution work.<br /><br />The problem is, in windows 8 and 10 &quot;Launch folder windows in a separate process&quot; seems to have a problem of it's own, like File replace dialogs popping under instead of popping over the file explorer windows that launch them.<br />This as you may imagine is annoying as frequently while doing file copy/move operations, File Replace Dialogs go unnoticed for some time before they get attended.

		

		</td>
	</tr>
	</table>


	<hr width="85%" />

	<table width="85%" cellspacing="3" cellpadding="0" border="0" align="center">
	<tr>
		<td width="10%" nowrap="nowrap">Author:&nbsp;</td>
		<td><b>MadMrMax</b> [ Mon Dec 11, 2017 4:10 pm ]</td>
	</tr>
	<tr>
		<td width="10%" nowrap="nowrap">Post subject:&nbsp;</td>
		<td><b>Re: Classic Shell Start Menu causes explorer lock up</b></td>
	</tr>
	<tr>
		<td colspan="2"><hr class="sep" />FWIW - I was encountering this same issue (Explorer locking up all waiting on one thread; usually happened after resuming from sleep/from unlock). I rolled-back Classic Shell to 4.2.4 and so far the problem has not manifested itself<br /><br /><br />-mark<br />Edit 12-12: that didn't work. repro'd the issue again

		

		</td>
	</tr>
	</table>


	<hr width="85%" />

	<table width="85%" cellspacing="3" cellpadding="0" border="0" align="center">
	<tr>
		<td width="10%" nowrap="nowrap">Author:&nbsp;</td>
		<td><b>Oriel</b> [ Thu Dec 21, 2017 11:05 pm ]</td>
	</tr>
	<tr>
		<td width="10%" nowrap="nowrap">Post subject:&nbsp;</td>
		<td><b>Re: Classic Shell Start Menu causes explorer lock up</b></td>
	</tr>
	<tr>
		<td colspan="2"><hr class="sep" />Hello everyone, i just created the account on the forum, first to say it's sad that the tool is no longer being supported/updated. It's been years of a magnificent job by Ivo, and just like many, i am one of those who thinks W10 looks horrible without CS.<br /><br />With that being said, i am sorry in advance if this is the wrong thread, i have been browsing for quite a while, but to be honest i am not entirely sure my issue is the same commented here, but nothing to lose with asking, right?.<br /><br />Here's the thing, and i'd like to point out that i am no computer expert.  I was one of those &quot;fortunate&quot; people getting the Fall Creatores update getting shoved down my throat on day one without any warning or permission. Everything seemed to work just fine, even CS, which gave me the typical &quot;updating&quot; line, or adapting files or something, i don't remember, and it worked well. I HAD and i still HAVE CS 4.3.0-es installed.<br /><br />A few days after FCU was installed, i had a full system lock up/freeze, that means that out of nowhere (browsing with chrome or firefox, maybe in steam, watching a movie or writing a note... anything really), the entire computer got frozen, the mouse wouldn't move, the keyboard wouldn't respond, the screen would remain the same, movie gets frozen, sound stops, and i couldn't even bring the tasks manager up (Cntrl+Alt+Del), nothing would respond, so i ended up having to reboot the computer the hard way (Reset). Everything worked fine after that, for DAYS, sometimes 10 days, sometimes 5, last couple of times it happened after 7 and 4 days respectively.<br /><br />Since W10 &quot;upgraded&quot; to the FCU, 3 months ago?, 2 and a half?, i have been pointing fingers at many different things... updated graphics drivers, checked the state of the hard drives, tried different internet browsers, updated some other programs, etc... but nothing i do seems to be fixing the issue, and the main problem is that in order to find out if my &quot;fixes&quot; actually fix the issue, i have to wait days until it gets reproduced. Also i checked the entire event viewer since FCU was installed, and no error appears to be recorded at the times of the crashes (i noted down the times of the crashes and what i was doing at that time, but... didn't help).<br /><br />So here is one of my last ideas to find out what the issue is, does Classic Shell have anything to do with this behaviour?, is my issue the same that is mentioned in this thread or other?. If so, is there a way to solve this?, even if the solution is to uninstall CS, seriously... it happens &quot;only&quot; once every few days, but it is really annoying, as a few times it &quot;almost&quot; killed hours of work (thankfully my browser did auto save most of it), and i am fearing it might eventually break something in the computer, as i have to manually reboot it with the reset button everytime it happens.<br /><br />In any case, thanks in advance for anyone who can cast some light into this issue, and sorry if i missed some information in previous posts that would answer my question, as i said, my knowledge about computers is limited, and sometimes all i read sounds chinese to me :/<br /><br />Hugs, thanks again!

		

		</td>
	</tr>
	</table>


	<hr width="85%" />

	<table width="85%" cellspacing="3" cellpadding="0" border="0" align="center">
	<tr>
		<td width="10%" nowrap="nowrap">Author:&nbsp;</td>
		<td><b>Jcee</b> [ Fri Dec 22, 2017 3:36 am ]</td>
	</tr>
	<tr>
		<td width="10%" nowrap="nowrap">Post subject:&nbsp;</td>
		<td><b>Re: Classic Shell Start Menu causes explorer lock up</b></td>
	</tr>
	<tr>
		<td colspan="2"><hr class="sep" />It could potentially be related to classic shell, because classic shell hooks into explorer.. since it is something that happens occasionally,  It would be hard indeed to nail down the culprit. but you could always uninstall classic shell for a few days, to see if the issue goes away (if it happens again, classic shell is probably not to blame and you can then re-install it)<br /><br />Something else to consider is a full system reset, which is fairly straight forward on windows 10, so even a novice can do it (reinstallation is one of the few things windows 10 does right)<br />Make sure that all your files are backed up on another hardrive or flashdrive (only the C: drive gets wiped)

		

		</td>
	</tr>
	</table>


	<hr width="85%" />

	<table width="85%" cellspacing="3" cellpadding="0" border="0" align="center">
	<tr>
		<td width="10%" nowrap="nowrap">Author:&nbsp;</td>
		<td><b>Oriel</b> [ Fri Dec 22, 2017 5:08 am ]</td>
	</tr>
	<tr>
		<td width="10%" nowrap="nowrap">Post subject:&nbsp;</td>
		<td><b>Re: Classic Shell Start Menu causes explorer lock up</b></td>
	</tr>
	<tr>
		<td colspan="2"><hr class="sep" />Thing is that according to what i've been reading here if i uninstall CS it might not work again, right?, so i wanted to avoid uninstalling it if it's not responsible. Plus what i am reading is that this lock ups/freezing people are having can be reverted by opening the tasks manager, but i cannot even access that when it happens, that's the detail that makes me doubt...<br /><br />PS: I wouldn't even know how to start with that reinstall you mentioned... plus in the mind of someone like me it sounds like the end of times <img src="images/smilies/icon_razz.gif" alt=":P" title="Razz" />

		

		</td>
	</tr>
	</table>


	<hr width="85%" />

	<table width="85%" cellspacing="3" cellpadding="0" border="0" align="center">
	<tr>
		<td width="10%" nowrap="nowrap">Author:&nbsp;</td>
		<td><b>Jcee</b> [ Fri Dec 22, 2017 5:51 am ]</td>
	</tr>
	<tr>
		<td width="10%" nowrap="nowrap">Post subject:&nbsp;</td>
		<td><b>Re: Classic Shell Start Menu causes explorer lock up</b></td>
	</tr>
	<tr>
		<td colspan="2"><hr class="sep" />I haven't heard of anyone lose classic shell completely after uninstalling it. you should be safe. I cant say the same about a system restore though, because a few people have had problems with 'fresh' copies of Windows 10 fall creators update

		

		</td>
	</tr>
	</table>


	<hr width="85%" />

	<table width="85%" cellspacing="3" cellpadding="0" border="0" align="center">
	<tr>
		<td width="10%" nowrap="nowrap">Author:&nbsp;</td>
		<td><b>Oriel</b> [ Fri Dec 22, 2017 6:01 am ]</td>
	</tr>
	<tr>
		<td width="10%" nowrap="nowrap">Post subject:&nbsp;</td>
		<td><b>Re: Classic Shell Start Menu causes explorer lock up</b></td>
	</tr>
	<tr>
		<td colspan="2"><hr class="sep" />Alright, well, i might give it a go and uninstall it to see what happens. Downside is that even if it works i may have to wait two weeks till i feel in the clear... *sigh*. Still, it's better than nothing. If someone else has some similar experience to mine i would appreciate the comment, would help me feel that at least i'm on the right track <img src="images/smilies/icon_razz.gif" alt=":P" title="Razz" />.<br /><br />In any case, thanks Jcee for the help <img src="images/smilies/icon_e_smile.gif" alt=":)" title="Smile" />

		

		</td>
	</tr>
	</table>


<hr width="85%" />

<table width="85%" cellspacing="3" cellpadding="0" border="0" align="center">
<tr>
	<td><span class="gensmall">Page <strong>2</strong> of <strong>2</strong></span></td>
	<td align="right"><span class="gensmall">All times are UTC - 8 hours [ <abbr title="Daylight Saving Time">DST</abbr> ]</span></td>
</tr>
<tr>
	<td colspan="2" align="center"><span class="gensmall">Powered by phpBB&reg; Forum Software &copy; phpBB Group<br />https://www.phpbb.com/</span></td>
</tr>
</table>

</body>

<!-- Mirrored from www.classicshell.net/forum/viewtopic.php?f=12&t=5954&start=50&view=print by HTTrack Website Copier/3.x [XR&CO'2014], Fri, 08 Jun 2018 05:12:43 GMT -->
</html>