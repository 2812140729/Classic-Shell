<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html dir="ltr" lang="en-gb">

<!-- Mirrored from www.classicshell.net/forum/viewtopic.php?f=12&t=5385&view=print by HTTrack Website Copier/3.x [XR&CO'2014], Fri, 08 Jun 2018 07:09:46 GMT -->
<!-- Added by HTTrack --><meta http-equiv="content-type" content="text/html;charset=UTF-8" /><!-- /Added by HTTrack -->
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta http-equiv="Content-Style-Type" content="text/css">
<meta http-equiv="Content-Language" content="en-gb">
<meta name="robots" content="noindex" />
<title>Classic Shell :: View topic - Crash involving ClassicStartMenuDLL.dll in RemoteApp</title>

<style type="text/css">
<!--

body {
	font-family: Verdana,serif;
	font-size: 10pt;
}

img {
	border: 0;
}

td {
	font-family: Verdana,serif;
	font-size: 10pt;
	line-height: 150%;
}

.code, .codecontent, 
.quote, .quotecontent {
	margin: 0 5px 0 5px;
	padding: 5px;
	font-size: smaller;
	border: black solid 1px;
}

.quotetitle {
	color: black;
	display : block;
	font-weight: bold;
}

.forum {
	font-family: Arial,Helvetica,sans-serif;
	font-weight: bold;
	font-size: 18pt;
}

.topic {
	font-family: Arial,Helvetica,sans-serif;
	font-size: 14pt;
	font-weight: bold;
}

.gensmall {
	font-size: 8pt;
}

hr {
	color: #888;
	height: 3px;
	border-style: solid;
}

hr.sep {
	color: #aaa;
	height: 1px;
	border-style: dashed;
}
//-->
</style>

</head>
<body>

<table width="85%" cellspacing="3" cellpadding="0" border="0" align="center">
<tr>
	<td colspan="2" align="center"><span class="Forum">Classic Shell</span><br /><span class="gensmall"><a href="index.html">http://www.classicshell.net/forum/</a></span></td>
</tr>
<tr>
	<td colspan="2"><br /></td>
</tr>
<tr>
	<td><span class="topic">Crash involving ClassicStartMenuDLL.dll in RemoteApp</span><br /><span class="gensmall"><a href="viewtopice27b.html?f=12&amp;t=5385">http://www.classicshell.net/forum/viewtopic.php?f=12&amp;t=5385</a></span></td>
	<td align="right" valign="bottom"><span class="gensmall">Page <strong>1</strong> of <strong>1</strong></span></td>
</tr>
</table>



	<hr width="85%" />

	<table width="85%" cellspacing="3" cellpadding="0" border="0" align="center">
	<tr>
		<td width="10%" nowrap="nowrap">Author:&nbsp;</td>
		<td><b>bottswana</b> [ Thu Nov 19, 2015 9:37 am ]</td>
	</tr>
	<tr>
		<td width="10%" nowrap="nowrap">Post subject:&nbsp;</td>
		<td><b>Crash involving ClassicStartMenuDLL.dll in RemoteApp</b></td>
	</tr>
	<tr>
		<td colspan="2"><hr class="sep" />Hello,<br /><br />We have Classic Shell installed on a Server 2012 R2 terminal server for testing, and also connect via RemoteApp (A reduced connection without a traditional explorer shell).<br />We don't intend to use Classic Shell when in RemoteApp (since there is no shell!) but we have noticed that when it is installed for normal desktop sessions, any RemoteApp sessions that are opened crash out on the RemoteApp process (rdpinit.exe) with a Faulting Module as ClassicStartMenuDLL.dll<br /><br /><div class="quotetitle"><b>Quote:</b></div><div class="quotecontent"><strong><span style="font-family:Segoe UI,sans-serif;"><span style="color:#0066CC;">Problem signature:</span></span></strong><br /><span style="font-family:Segoe UI,sans-serif;"><span style="color:black;"> Problem Event Name: APPCRASH</span></span><br /><span style="font-family:Segoe UI,sans-serif;"><span style="color:black;"> Application Name: rdpinit.exe</span></span><br /><span style="font-family:Segoe UI,sans-serif;"><span style="color:black;"> Application Version: 6.3.9600.17415</span></span><br /><span style="font-family:Segoe UI,sans-serif;"><span style="color:black;"> Application Timestamp: 54504afb</span></span><br /><span style="font-family:Segoe UI,sans-serif;"><span style="color:black;"> Fault Module Name: ClassicStartMenuDLL.dll</span></span><br /><span style="font-family:Segoe UI,sans-serif;"><span style="color:black;"> Fault Module Version: 4.2.4.0</span></span><br /><span style="font-family:Segoe UI,sans-serif;"><span style="color:black;"> Fault Module Timestamp: 55c7808a</span></span><br /><span style="font-family:Segoe UI,sans-serif;"><span style="color:black;"> Exception Code: c000041d</span></span><br /><span style="font-family:Segoe UI,sans-serif;"><span style="color:black;"> Exception Offset: 00000000000ce6cc</span></span><br /><span style="font-family:Segoe UI,sans-serif;"><span style="color:black;"> OS Version: 6.3.9600.2.0.0.144.8</span></span><br /><span style="font-family:Segoe UI,sans-serif;"><span style="color:black;"> Locale ID: 2057</span></span><br /><span style="font-family:Segoe UI,sans-serif;"><span style="color:black;"> Additional Information 1: 4330</span></span><br /><span style="font-family:Segoe UI,sans-serif;"><span style="color:black;"> Additional Information 2: 4330d2fef657c24dbbd687be2b1cf41d</span></span><br /><span style="font-family:Segoe UI,sans-serif;"><span style="color:black;"> Additional Information 3: 2c3c</span></span><br /><span style="font-family:Segoe UI,sans-serif;"><span style="color:black;"> Additional Information 4: 2c3cfea4c9d4c996ba42d1aa3c1707ef</span></span><br /></div><br />I have attached two crash dumps captured from rdpinit.exe when the crash occurs.<br />The issue can be replicated in our environment just by connecting in via RemoteApp and waiting for a few minutes. <br />The crash does not occur when users connect to the same server in a full RDP shell.<br />The issue is resolved by removing Classic Shell. We only have the Start Menu component and updater components installed.<br /><br />The version of Classic Shell is 4.2.5<br />Many Thanks,

		
			<br clear="all" /><br />

			<table class="tablebg" width="100%" cellspacing="1">
			<tr>
				<td><b class="genmed">Attachments: </b></td>
			</tr>
			
				<tr>
					<td>
			<span class="genmed">
				<img src="styles/subsilver2/imageset/icon_topic_attach.gif" width="14" height="18" alt="" title="" /> 
				<a href="download/filed76c.php?id=2840">rdpinit-crashdump.zip</a> [212.75 KiB]
			</span><br />
			<span class="gensmall">Downloaded 177 times</span>
		

		<br />
	</td>
				</tr>
			
			</table>
		

		</td>
	</tr>
	</table>


	<hr width="85%" />

	<table width="85%" cellspacing="3" cellpadding="0" border="0" align="center">
	<tr>
		<td width="10%" nowrap="nowrap">Author:&nbsp;</td>
		<td><b>Ivo</b> [ Thu Nov 19, 2015 9:59 am ]</td>
	</tr>
	<tr>
		<td width="10%" nowrap="nowrap">Post subject:&nbsp;</td>
		<td><b>Re: Crash involving ClassicStartMenuDLL.ddl in RemoteApp</b></td>
	</tr>
	<tr>
		<td colspan="2"><hr class="sep" />Looks like ClassicStartMenu.exe is trying to inject into the rdpinit.exe instead of explorer.exe. It is possible rdpinit is creating a window with the same class name &quot;Shell_TrayWnd&quot; as the taskbar. That's not a supported scenario.<br />I may add some extra safety checks in the future, but at the moment I don't know what they'll be.

		

		</td>
	</tr>
	</table>


	<hr width="85%" />

	<table width="85%" cellspacing="3" cellpadding="0" border="0" align="center">
	<tr>
		<td width="10%" nowrap="nowrap">Author:&nbsp;</td>
		<td><b>bottswana</b> [ Thu Nov 19, 2015 10:33 am ]</td>
	</tr>
	<tr>
		<td width="10%" nowrap="nowrap">Post subject:&nbsp;</td>
		<td><b>Re: Crash involving ClassicStartMenuDLL.ddl in RemoteApp</b></td>
	</tr>
	<tr>
		<td colspan="2"><hr class="sep" />That makes sense, my understanding is rdpinit is meant to be a lightweight shell based on explorer without most of the UX elements.<br />Is there any way to blacklist it from hooking into rdpinit? I don't mind helping test a solution, but we are going to have to push these servers into production at some point most likely without Classic Shell, which would suck because we all (and our users) love it!

		

		</td>
	</tr>
	</table>


	<hr width="85%" />

	<table width="85%" cellspacing="3" cellpadding="0" border="0" align="center">
	<tr>
		<td width="10%" nowrap="nowrap">Author:&nbsp;</td>
		<td><b>rood</b> [ Tue Dec 08, 2015 2:42 am ]</td>
	</tr>
	<tr>
		<td width="10%" nowrap="nowrap">Post subject:&nbsp;</td>
		<td><b>Re: Crash involving ClassicStartMenuDLL.dll in RemoteApp</b></td>
	</tr>
	<tr>
		<td colspan="2"><hr class="sep" />We are having the same problem with Classic Startmenu and Windows 2012 R2 RDS. Is there already a workaround available? RemoteApp is now crashing after a few seconds. Thnx!

		

		</td>
	</tr>
	</table>


	<hr width="85%" />

	<table width="85%" cellspacing="3" cellpadding="0" border="0" align="center">
	<tr>
		<td width="10%" nowrap="nowrap">Author:&nbsp;</td>
		<td><b>Ivo</b> [ Tue Dec 08, 2015 10:14 am ]</td>
	</tr>
	<tr>
		<td width="10%" nowrap="nowrap">Post subject:&nbsp;</td>
		<td><b>Re: Crash involving ClassicStartMenuDLL.dll in RemoteApp</b></td>
	</tr>
	<tr>
		<td colspan="2"><hr class="sep" />Try the attached zip file. It replaces two of the files in the Program Files\Classic Shell directory.<br />You will have to exit the start menu when you do the swap. Right-click on the start button and select Exit.<br /><br /><span style="color:#ff0000;"><strong>Note that the attached file is only for Classic Shell 4.2.5. Replacing the files if you have a later version installed may not fix your issue and this fix below is most probably already included in versions of Classic Shell after 4.2.5.</strong></span>

		
			<br clear="all" /><br />

			<table class="tablebg" width="100%" cellspacing="1">
			<tr>
				<td><b class="genmed">Attachments: </b></td>
			</tr>
			
				<tr>
					<td>
			<span class="genmed">
				<img src="styles/subsilver2/imageset/icon_topic_attach.gif" width="14" height="18" alt="" title="" /> 
				<a href="download/filece51.php?id=2900">ClassicStartMenu.zip</a> [1.49 MiB]
			</span><br />
			<span class="gensmall">Downloaded 267 times</span>
		

		<br />
	</td>
				</tr>
			
			</table>
		

		</td>
	</tr>
	</table>


	<hr width="85%" />

	<table width="85%" cellspacing="3" cellpadding="0" border="0" align="center">
	<tr>
		<td width="10%" nowrap="nowrap">Author:&nbsp;</td>
		<td><b>rood</b> [ Wed Dec 16, 2015 12:42 am ]</td>
	</tr>
	<tr>
		<td width="10%" nowrap="nowrap">Post subject:&nbsp;</td>
		<td><b>Re: Crash involving ClassicStartMenuDLL.dll in RemoteApp</b></td>
	</tr>
	<tr>
		<td colspan="2"><hr class="sep" />It works <img src="images/smilies/icon_e_biggrin.gif" alt=":D" title="Very Happy" /><br />Thnx for the quick response!

		

		</td>
	</tr>
	</table>


	<hr width="85%" />

	<table width="85%" cellspacing="3" cellpadding="0" border="0" align="center">
	<tr>
		<td width="10%" nowrap="nowrap">Author:&nbsp;</td>
		<td><b>Gaurav</b> [ Wed Dec 16, 2015 2:06 am ]</td>
	</tr>
	<tr>
		<td width="10%" nowrap="nowrap">Post subject:&nbsp;</td>
		<td><b>Re: Crash involving ClassicStartMenuDLL.dll in RemoteApp</b></td>
	</tr>
	<tr>
		<td colspan="2"><hr class="sep" />@bottswana, can you try the fix too and verify it works? I could only get Classic Start Menu to crash once in a RemoteApp session with Word running and never again after that.

		

		</td>
	</tr>
	</table>


<hr width="85%" />

<table width="85%" cellspacing="3" cellpadding="0" border="0" align="center">
<tr>
	<td><span class="gensmall">Page <strong>1</strong> of <strong>1</strong></span></td>
	<td align="right"><span class="gensmall">All times are UTC - 8 hours [ <abbr title="Daylight Saving Time">DST</abbr> ]</span></td>
</tr>
<tr>
	<td colspan="2" align="center"><span class="gensmall">Powered by phpBB&reg; Forum Software &copy; phpBB Group<br />https://www.phpbb.com/</span></td>
</tr>
</table>

</body>

<!-- Mirrored from www.classicshell.net/forum/viewtopic.php?f=12&t=5385&view=print by HTTrack Website Copier/3.x [XR&CO'2014], Fri, 08 Jun 2018 07:09:46 GMT -->
</html>