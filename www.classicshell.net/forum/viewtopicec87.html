<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html dir="ltr" lang="en-gb">

<!-- Mirrored from www.classicshell.net/forum/viewtopic.php?f=8&t=6482&view=print by HTTrack Website Copier/3.x [XR&CO'2014], Fri, 08 Jun 2018 04:07:47 GMT -->
<!-- Added by HTTrack --><meta http-equiv="content-type" content="text/html;charset=UTF-8" /><!-- /Added by HTTrack -->
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta http-equiv="Content-Style-Type" content="text/css">
<meta http-equiv="Content-Language" content="en-gb">
<meta name="robots" content="noindex" />
<title>Classic Shell :: View topic - Open cmd window here / Cmd as admin / Open as admin buttons</title>

<style type="text/css">
<!--

body {
	font-family: Verdana,serif;
	font-size: 10pt;
}

img {
	border: 0;
}

td {
	font-family: Verdana,serif;
	font-size: 10pt;
	line-height: 150%;
}

.code, .codecontent, 
.quote, .quotecontent {
	margin: 0 5px 0 5px;
	padding: 5px;
	font-size: smaller;
	border: black solid 1px;
}

.quotetitle {
	color: black;
	display : block;
	font-weight: bold;
}

.forum {
	font-family: Arial,Helvetica,sans-serif;
	font-weight: bold;
	font-size: 18pt;
}

.topic {
	font-family: Arial,Helvetica,sans-serif;
	font-size: 14pt;
	font-weight: bold;
}

.gensmall {
	font-size: 8pt;
}

hr {
	color: #888;
	height: 3px;
	border-style: solid;
}

hr.sep {
	color: #aaa;
	height: 1px;
	border-style: dashed;
}
//-->
</style>

</head>
<body>

<table width="85%" cellspacing="3" cellpadding="0" border="0" align="center">
<tr>
	<td colspan="2" align="center"><span class="Forum">Classic Shell</span><br /><span class="gensmall"><a href="index.html">http://www.classicshell.net/forum/</a></span></td>
</tr>
<tr>
	<td colspan="2"><br /></td>
</tr>
<tr>
	<td><span class="topic">Open cmd window here / Cmd as admin / Open as admin buttons</span><br /><span class="gensmall"><a href="viewtopicf77c.html?f=8&amp;t=6482">http://www.classicshell.net/forum/viewtopic.php?f=8&amp;t=6482</a></span></td>
	<td align="right" valign="bottom"><span class="gensmall">Page <strong>1</strong> of <strong>1</strong></span></td>
</tr>
</table>



	<hr width="85%" />

	<table width="85%" cellspacing="3" cellpadding="0" border="0" align="center">
	<tr>
		<td width="10%" nowrap="nowrap">Author:&nbsp;</td>
		<td><b>Gaurav</b> [ Fri Aug 05, 2016 9:12 am ]</td>
	</tr>
	<tr>
		<td width="10%" nowrap="nowrap">Post subject:&nbsp;</td>
		<td><b>Open cmd window here / Cmd as admin / Open as admin buttons&nbsp;&nbsp;<img src="styles/subsilver2/imageset/icon_topic_solved_post.png" width="12" height="12" alt="Topic is solved" title="Topic is solved" /></b></td>
	</tr>
	<tr>
		<td colspan="2"><hr class="sep" />Here is a way to add buttons to the Classic Explorer toolbar to add some useful functionality:<br /><br /><strong><span style="text-decoration: underline"><span style="font-size: 150%; line-height: 116%;">Open command prompt at currently open or currently selected folder:</span></span></strong><br /><br />1. Open Classic Explorer Settings<br />2. Make sure &quot;Show all settings&quot; is checked at the top and go to Toolbar Buttons tab.<br />3. Scroll down in the right column and add &quot;Custom&quot; item to left column by drag and drop from right column to left column.<br />4. Double click 'Custom' in left column.<br />5. Type this in the &quot;Command:&quot; field:<br /><br />cmd /k pushd &quot;%2&quot;<br /><br />6. For Tip or Label type anything you want. For example,<br /><br /><strong>Open command prompt here</strong><br /><br />7. Pick an icon.<br />8. Click OK everywhere to save settings. Close and reopen the Explorer window.<br /><br />This is how the button works:<br />- When a folder is selected in left/navigation/folder pane, command prompt will open there<br />- When a folder is selected in the right pane (files pane), command prompt will open there<br />- For a network path e.g. \\Windows-PC\Share1\Folder 1, it will work if the folder is selected in the right pane of Explorer<br />- If you have a mapped drive letter to a network share, it will work as well for navigation (left) pane and files (right) pane <br /><br /><strong><span style="text-decoration: underline"><span style="font-size: 150%; line-height: 116%;">Open command prompt as administrator at currently open or currently selected folder:</span></span></strong><br /><br /><br />1. Download NirCmd, a free useful, trusted tool from here: <!-- m --><a class="postlink" href="http://www.nirsoft.net/utils/nircmd.html">http://www.nirsoft.net/utils/nircmd.html</a><!-- m --> and copy it to your C:\Windows directory. If you are using 32-bit Windows, download 32-bit Nircmd. If 64-bit Windows, then 64-bit Nircmd.<br /><br />2. Open Windows Explorer and go to C:\Program Files\Classic Shell. Create a folder called Commands.<br /><br />3. Start Notepad as administrator and copy-paste this text into Notepad:<br /><div class="codetitle"><b>Code:</b></div><div class="codecontent">@echo off<br />If Defined selecteddir goto AdminCmdPrompt2 else goto AdminCmdPrompt1<br /><br />:AdminCmdPrompt1<br />pushd %currentdir%<br />goto end<br /><br />:AdminCmdPrompt2<br />pushd %selecteddir%<br />goto end<br /><br />:End<br />CLS</div><br /><br /><br />4. Save this file as <strong>&quot;AdminCmdPrompt.bat&quot;</strong> in C:\Program Files\Classic Shell\Commands.<br />5. Open Classic Explorer Settings<br />6. Make sure &quot;Show all settings&quot; is checked at the top and go to Toolbar Buttons tab.<br />7. Scroll down in the right column and add &quot;Custom&quot; item to left column by drag and drop from right column to left column.<br />8. Double click 'Custom' in left column.<br />9. Type this in the &quot;Command:&quot; field:<br /><br />nircmd elevate cmd /e:on /k pushd &quot;%1&quot; &amp; set %selecteddir%=&quot;%2&quot; &amp; set %currentdir%=&quot;%1&quot; &amp; &quot;%ProgramFiles%\Classic Shell\Commands\AdminCmdPrompt.bat&quot;<br /><br />10. For Tip or Label type anything you want. For example,<br /><br /><strong>Open command prompt here as administrator</strong><br /><br />11. Pick an icon.<br />12. Click OK everywhere to save settings. Close and reopen the Explorer window.<br /><br />This is how the button works:<br />- When a folder is selected in left/navigation/folder pane, command prompt will open there<br />- When a folder is selected in the right pane (files pane), command prompt will open there<br />- For a network path e.g. \\Windows-PC\Share1\Folder 1, it will work similarly!<br />- If you have a mapped drive letter to a network share, it will work similarly!<br /><br /><strong><span style="text-decoration: underline"><span style="font-size: 150%; line-height: 116%;">Open (any file) as administrator / Run program as administrator:</span></span></strong><br /><strong><br /></strong><br />This is very useful too. For example, there might be some file in a UAC protected location which you need to modify as admin. Or run a program from Explorer as admin without context menu.<br /><br />1. Download NirCmd, a free useful, trusted tool from here: <!-- m --><a class="postlink" href="http://www.nirsoft.net/utils/nircmd.html">http://www.nirsoft.net/utils/nircmd.html</a><!-- m --> and copy it to your C:\Windows directory. If you are using 32-bit Windows, download 32-bit Nircmd. If 64-bit Windows, then 64-bit Nircmd.<br /><br />2. Open Classic Explorer Settings<br />3. Make sure &quot;Show all settings&quot; is checked at the top and go to Toolbar Buttons tab.<br />4. Scroll down in the right column and add &quot;Custom&quot; item to left column by drag and drop from right column to left column.<br />5. Double click 'Custom' in left column.<br />6. Type this in the &quot;Command:&quot; field:<br /><br />nircmd elevate &quot;%2&quot;<br />7. For Tip or Label type anything you want. For example,<br /><br /><strong>Open as administrator</strong><br /><br />8. Pick an icon.<br />9. Click OK everywhere to save settings. Close and reopen the Explorer window.<br /><br />Any item (file or folder) which you select in the right pane of Explorer can be opened as administrator. Even documents, pictures, music, videos and other file types will open with the default associated program as administrator.

		

		</td>
	</tr>
	</table>


<hr width="85%" />

<table width="85%" cellspacing="3" cellpadding="0" border="0" align="center">
<tr>
	<td><span class="gensmall">Page <strong>1</strong> of <strong>1</strong></span></td>
	<td align="right"><span class="gensmall">All times are UTC - 8 hours [ <abbr title="Daylight Saving Time">DST</abbr> ]</span></td>
</tr>
<tr>
	<td colspan="2" align="center"><span class="gensmall">Powered by phpBB&reg; Forum Software &copy; phpBB Group<br />https://www.phpbb.com/</span></td>
</tr>
</table>

</body>

<!-- Mirrored from www.classicshell.net/forum/viewtopic.php?f=8&t=6482&view=print by HTTrack Website Copier/3.x [XR&CO'2014], Fri, 08 Jun 2018 04:07:47 GMT -->
</html>