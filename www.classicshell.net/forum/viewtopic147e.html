<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html dir="ltr" lang="en-gb">

<!-- Mirrored from www.classicshell.net/forum/viewtopic.php?f=13&t=7266&view=print by HTTrack Website Copier/3.x [XR&CO'2014], Fri, 08 Jun 2018 09:38:14 GMT -->
<!-- Added by HTTrack --><meta http-equiv="content-type" content="text/html;charset=UTF-8" /><!-- /Added by HTTrack -->
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta http-equiv="Content-Style-Type" content="text/css">
<meta http-equiv="Content-Language" content="en-gb">
<meta name="robots" content="noindex" />
<title>Classic Shell :: View topic - Run as a Service?</title>

<style type="text/css">
<!--

body {
	font-family: Verdana,serif;
	font-size: 10pt;
}

img {
	border: 0;
}

td {
	font-family: Verdana,serif;
	font-size: 10pt;
	line-height: 150%;
}

.code, .codecontent, 
.quote, .quotecontent {
	margin: 0 5px 0 5px;
	padding: 5px;
	font-size: smaller;
	border: black solid 1px;
}

.quotetitle {
	color: black;
	display : block;
	font-weight: bold;
}

.forum {
	font-family: Arial,Helvetica,sans-serif;
	font-weight: bold;
	font-size: 18pt;
}

.topic {
	font-family: Arial,Helvetica,sans-serif;
	font-size: 14pt;
	font-weight: bold;
}

.gensmall {
	font-size: 8pt;
}

hr {
	color: #888;
	height: 3px;
	border-style: solid;
}

hr.sep {
	color: #aaa;
	height: 1px;
	border-style: dashed;
}
//-->
</style>

</head>
<body>

<table width="85%" cellspacing="3" cellpadding="0" border="0" align="center">
<tr>
	<td colspan="2" align="center"><span class="Forum">Classic Shell</span><br /><span class="gensmall"><a href="index.html">http://www.classicshell.net/forum/</a></span></td>
</tr>
<tr>
	<td colspan="2"><br /></td>
</tr>
<tr>
	<td><span class="topic">Run as a Service?</span><br /><span class="gensmall"><a href="viewtopic3f8f.html?f=13&amp;t=7266">http://www.classicshell.net/forum/viewtopic.php?f=13&amp;t=7266</a></span></td>
	<td align="right" valign="bottom"><span class="gensmall">Page <strong>1</strong> of <strong>1</strong></span></td>
</tr>
</table>



	<hr width="85%" />

	<table width="85%" cellspacing="3" cellpadding="0" border="0" align="center">
	<tr>
		<td width="10%" nowrap="nowrap">Author:&nbsp;</td>
		<td><b>beatyas</b> [ Tue Jan 17, 2017 3:27 pm ]</td>
	</tr>
	<tr>
		<td width="10%" nowrap="nowrap">Post subject:&nbsp;</td>
		<td><b>Run as a Service?</b></td>
	</tr>
	<tr>
		<td colspan="2"><hr class="sep" />I did NOT exhaustively seek out every possible forum post... Not going to...<br /><br />Is there a way to get Classic Start to run under the \SVCHOST.EXE\RUNTIMEBROKER.EXE in Win10 by default...? It should not be a current user explorer.exe sub-process. Needs to be a local machine 'interactive' one... If you pull down a copy of the SysInternals suite, you can see the security ownership relationship of 'where' ClassicShell is running... At least on my machine, if it runs as a job process under RUNTIMEBROKER.EXE, it seems to respond much faster, than as a user-admin account...<br />Sorry if this does not make sense...

		

		</td>
	</tr>
	</table>


	<hr width="85%" />

	<table width="85%" cellspacing="3" cellpadding="0" border="0" align="center">
	<tr>
		<td width="10%" nowrap="nowrap">Author:&nbsp;</td>
		<td><b>Ivo</b> [ Tue Jan 17, 2017 3:31 pm ]</td>
	</tr>
	<tr>
		<td width="10%" nowrap="nowrap">Post subject:&nbsp;</td>
		<td><b>Re: Run as a Service?</b></td>
	</tr>
	<tr>
		<td colspan="2"><hr class="sep" />All of the start menu functionality runs inside the Explorer.exe process. The ClassicStartMenu.exe process is not important for performance. You can even kill it and the menu will still work.

		

		</td>
	</tr>
	</table>


	<hr width="85%" />

	<table width="85%" cellspacing="3" cellpadding="0" border="0" align="center">
	<tr>
		<td width="10%" nowrap="nowrap">Author:&nbsp;</td>
		<td><b>beatyas</b> [ Tue Jan 17, 2017 3:32 pm ]</td>
	</tr>
	<tr>
		<td width="10%" nowrap="nowrap">Post subject:&nbsp;</td>
		<td><b>Re: Run as a Service?</b></td>
	</tr>
	<tr>
		<td colspan="2"><hr class="sep" /><div class="quotetitle">Ivo wrote:</div><div class="quotecontent">All of the start menu functionality runs inside the Explorer.exe process. The ClassicStartMenu.exe process is not important for performance. You can even kill it and the menu will still work.</div><br /><br /><br />Not true... Hold on.. graphics incoming...

		

		</td>
	</tr>
	</table>


	<hr width="85%" />

	<table width="85%" cellspacing="3" cellpadding="0" border="0" align="center">
	<tr>
		<td width="10%" nowrap="nowrap">Author:&nbsp;</td>
		<td><b>beatyas</b> [ Tue Jan 17, 2017 3:40 pm ]</td>
	</tr>
	<tr>
		<td width="10%" nowrap="nowrap">Post subject:&nbsp;</td>
		<td><b>Re: Run as a Service?</b></td>
	</tr>
	<tr>
		<td colspan="2"><hr class="sep" /><div class="quotetitle">beatyas wrote:</div><div class="quotecontent"><div class="quotetitle">Ivo wrote:</div><div class="quotecontent">All of the start menu functionality runs inside the Explorer.exe process. The ClassicStartMenu.exe process is not important for performance. You can even kill it and the menu will still work.</div><br /><br /><br />Not true... Hold on.. graphics incoming...</div><br /><br /><br />Blocked from inserting images...

		

		</td>
	</tr>
	</table>


	<hr width="85%" />

	<table width="85%" cellspacing="3" cellpadding="0" border="0" align="center">
	<tr>
		<td width="10%" nowrap="nowrap">Author:&nbsp;</td>
		<td><b>beatyas</b> [ Tue Jan 17, 2017 3:44 pm ]</td>
	</tr>
	<tr>
		<td width="10%" nowrap="nowrap">Post subject:&nbsp;</td>
		<td><b>Re: Run as a Service?</b></td>
	</tr>
	<tr>
		<td colspan="2"><hr class="sep" /><div class="quotetitle">beatyas wrote:</div><div class="quotecontent"><div class="quotetitle">beatyas wrote:</div><div class="quotecontent"><div class="quotetitle">Ivo wrote:</div><div class="quotecontent">All of the start menu functionality runs inside the Explorer.exe process. The ClassicStartMenu.exe process is not important for performance. You can even kill it and the menu will still work.</div><br /><br /><br />Not true... Hold on.. graphics incoming...</div><br /><br /><br />Blocked from inserting images...</div><br /><br /><br />You can run the menu 'manually' as a system user and it will nest under \WININIT.EXE\SVCHOST.EXE\RUNTIMEBROKER.EXE as a process image... runs super-quick that way...<br />... Under the user EXPLORER.EXE.... seems to run slower...

		

		</td>
	</tr>
	</table>


	<hr width="85%" />

	<table width="85%" cellspacing="3" cellpadding="0" border="0" align="center">
	<tr>
		<td width="10%" nowrap="nowrap">Author:&nbsp;</td>
		<td><b>Ivo</b> [ Tue Jan 17, 2017 5:48 pm ]</td>
	</tr>
	<tr>
		<td width="10%" nowrap="nowrap">Post subject:&nbsp;</td>
		<td><b>Re: Run as a Service?</b></td>
	</tr>
	<tr>
		<td colspan="2"><hr class="sep" />The code is designed to run inside the Explorer process. Otherwise some features will not work. For example the part that handles the Win key or replaces the start button.

		

		</td>
	</tr>
	</table>


	<hr width="85%" />

	<table width="85%" cellspacing="3" cellpadding="0" border="0" align="center">
	<tr>
		<td width="10%" nowrap="nowrap">Author:&nbsp;</td>
		<td><b>Anixx</b> [ Sat Feb 04, 2017 10:43 am ]</td>
	</tr>
	<tr>
		<td width="10%" nowrap="nowrap">Post subject:&nbsp;</td>
		<td><b>Re: Run as a Service?</b></td>
	</tr>
	<tr>
		<td colspan="2"><hr class="sep" /><div class="quotetitle">Ivo wrote:</div><div class="quotecontent">All of the start menu functionality runs inside the Explorer.exe process. The ClassicStartMenu.exe process is not important for performance. You can even kill it and the menu will still work.</div><br /><br />What this process is for then? Why not just to kill it every time?<br /><br />Is it possible to run Classic Shell without this process using some options?

		

		</td>
	</tr>
	</table>


	<hr width="85%" />

	<table width="85%" cellspacing="3" cellpadding="0" border="0" align="center">
	<tr>
		<td width="10%" nowrap="nowrap">Author:&nbsp;</td>
		<td><b>Ivo</b> [ Sat Feb 04, 2017 10:51 am ]</td>
	</tr>
	<tr>
		<td width="10%" nowrap="nowrap">Post subject:&nbsp;</td>
		<td><b>Re: Run as a Service?</b></td>
	</tr>
	<tr>
		<td colspan="2"><hr class="sep" />It is the process that injects the DLL into Explorer. It also watches for Explorer being restarted to do the injection again. And it does some other non-essential work.

		

		</td>
	</tr>
	</table>


	<hr width="85%" />

	<table width="85%" cellspacing="3" cellpadding="0" border="0" align="center">
	<tr>
		<td width="10%" nowrap="nowrap">Author:&nbsp;</td>
		<td><b>Splitwirez</b> [ Sat Feb 04, 2017 11:32 am ]</td>
	</tr>
	<tr>
		<td width="10%" nowrap="nowrap">Post subject:&nbsp;</td>
		<td><b>Re: Run as a Service?</b></td>
	</tr>
	<tr>
		<td colspan="2"><hr class="sep" /><div class="quotetitle">Ivo wrote:</div><div class="quotecontent">It is the process that injects the DLL into Explorer. It also watches for Explorer being restarted to do the injection again. And it does some other non-essential work.</div><br /><br />Question...does it assume that explorer is being run from a specific location? Because I noticed that, when I ran Windows Vista's explorer on Windows 10 out of a subfolder of the Documents userfolder, Classic Shell didn't do the thing. (And this was an old version of Classic Shell, from before Vista support was removed.)<br /><br />Any workarounds? Or better still, ways to get a newer version to work on Vista's explorer on Windows 10 in this configuration? O:

		

		</td>
	</tr>
	</table>


	<hr width="85%" />

	<table width="85%" cellspacing="3" cellpadding="0" border="0" align="center">
	<tr>
		<td width="10%" nowrap="nowrap">Author:&nbsp;</td>
		<td><b>Ivo</b> [ Sat Feb 04, 2017 11:42 am ]</td>
	</tr>
	<tr>
		<td width="10%" nowrap="nowrap">Post subject:&nbsp;</td>
		<td><b>Re: Run as a Service?</b></td>
	</tr>
	<tr>
		<td colspan="2"><hr class="sep" />The Explorer that's important is the one that runs the desktop and the taskbar. Individual Explorer windows that show specific folders are ignored. That's of course if we are talking about the Classic Start Menu.<br /><br />If you are talking about Classic Explorer, then no, the location of the EXE doesn't matter as long as it is called &quot;explorer.exe&quot;. However based on the detected Windows version, certain behavior is expected from Explorer. If you are running the Vista explorer.exe on Windows 10, you are deep into unsupported territory <img src="images/smilies/icon_e_smile.gif" alt=":)" title="Smile" />

		

		</td>
	</tr>
	</table>


	<hr width="85%" />

	<table width="85%" cellspacing="3" cellpadding="0" border="0" align="center">
	<tr>
		<td width="10%" nowrap="nowrap">Author:&nbsp;</td>
		<td><b>Splitwirez</b> [ Sat Feb 04, 2017 11:47 am ]</td>
	</tr>
	<tr>
		<td width="10%" nowrap="nowrap">Post subject:&nbsp;</td>
		<td><b>Re: Run as a Service?</b></td>
	</tr>
	<tr>
		<td colspan="2"><hr class="sep" /><div class="quotetitle">Ivo wrote:</div><div class="quotecontent">The Explorer that's important is the one that runs the desktop and the taskbar.</div><br />That's the one I meant. I was using Vista's explorer for Desktop/Taskbar and 10's for individual windows. All I want is any kind of Start Menu on Vista's taskbar... (the built-in one doesn't work on 10 for [INSERT REASON HERE] .-. )<br /><br /><div class="quotetitle">Ivo wrote:</div><div class="quotecontent">If you are talking about Classic Explorer, then no, the location of the EXE doesn't matter as long as it is called &quot;explorer.exe&quot;.</div><br />Classic Explorer isn't really of any concern to mem for reasons stated above.<br /><br /><div class="quotetitle">Ivo wrote:</div><div class="quotecontent">However based on the detected Windows version, certain behavior is expected from Explorer. If you are running the Vista explorer.exe on Windows 10, you are deep into unsupported territory <img src="images/smilies/icon_e_smile.gif" alt=":)" title="Smile" /></div><br />...uh...that's basically your way of saying &quot;good luck, you're on your own&quot;, isn't it? ._.

		

		</td>
	</tr>
	</table>


	<hr width="85%" />

	<table width="85%" cellspacing="3" cellpadding="0" border="0" align="center">
	<tr>
		<td width="10%" nowrap="nowrap">Author:&nbsp;</td>
		<td><b>Ivo</b> [ Sat Feb 04, 2017 11:57 am ]</td>
	</tr>
	<tr>
		<td width="10%" nowrap="nowrap">Post subject:&nbsp;</td>
		<td><b>Re: Run as a Service?</b></td>
	</tr>
	<tr>
		<td colspan="2"><hr class="sep" />Yup, you are on your own <img src="images/smilies/icon_e_smile.gif" alt=":)" title="Smile" /> I can't even begin to think of what can go wrong in such scenario...

		

		</td>
	</tr>
	</table>


	<hr width="85%" />

	<table width="85%" cellspacing="3" cellpadding="0" border="0" align="center">
	<tr>
		<td width="10%" nowrap="nowrap">Author:&nbsp;</td>
		<td><b>Splitwirez</b> [ Sat Feb 04, 2017 12:08 pm ]</td>
	</tr>
	<tr>
		<td width="10%" nowrap="nowrap">Post subject:&nbsp;</td>
		<td><b>Re: Run as a Service?</b></td>
	</tr>
	<tr>
		<td colspan="2"><hr class="sep" /><div class="quotetitle">Ivo wrote:</div><div class="quotecontent">Yup, you are on your own <img src="images/smilies/icon_e_smile.gif" alt=":)" title="Smile" /> I can't even begin to think of what can go wrong in such scenario...</div><br /><br />Oh, that's comforting...<br /><br />...good think I'm doing all of this in a VM <img src="images/smilies/icon_lol.gif" alt=":lol:" title="Laughing" />

		

		</td>
	</tr>
	</table>


	<hr width="85%" />

	<table width="85%" cellspacing="3" cellpadding="0" border="0" align="center">
	<tr>
		<td width="10%" nowrap="nowrap">Author:&nbsp;</td>
		<td><b>Anixx</b> [ Sun Feb 05, 2017 7:25 am ]</td>
	</tr>
	<tr>
		<td width="10%" nowrap="nowrap">Post subject:&nbsp;</td>
		<td><b>Re: Run as a Service?</b></td>
	</tr>
	<tr>
		<td colspan="2"><hr class="sep" /><div class="quotetitle">Ivo wrote:</div><div class="quotecontent">It is the process that injects the DLL into Explorer. It also watches for Explorer being restarted to do the injection again. And it does some other non-essential work.</div><br /><br />So what if I put a bat file with it it into Autostart folder? It will start with Explorer, and then kill ClassicStartMenu.exe. Did you consider an option to put it into AutoStar and when the works is done make it exit? <br /><br />If I am not mistaken, Autostart folder runs every time Explorer is restarted (may be wrong).<br /><br />I also usually restart Explorer via Userinit because of other shell extensions such as ShellFolderFix.<br /><br />Maybe there should be added an option to make this process exit after it have done its work?

		

		</td>
	</tr>
	</table>


	<hr width="85%" />

	<table width="85%" cellspacing="3" cellpadding="0" border="0" align="center">
	<tr>
		<td width="10%" nowrap="nowrap">Author:&nbsp;</td>
		<td><b>Anixx</b> [ Sun Feb 05, 2017 7:29 am ]</td>
	</tr>
	<tr>
		<td width="10%" nowrap="nowrap">Post subject:&nbsp;</td>
		<td><b>Re: Run as a Service?</b></td>
	</tr>
	<tr>
		<td colspan="2"><hr class="sep" /><div class="quotetitle">Ivo wrote:</div><div class="quotecontent">Yup, you are on your own <img src="images/smilies/icon_e_smile.gif" alt=":)" title="Smile" /> I can't even begin to think of what can go wrong in such scenario...</div><br /><br />Actually it is quite important thing to have a classic taskbar under Win10, and running Vista Explorer under Win10 is a solution, only if Classic Shell was working in this setup...

		

		</td>
	</tr>
	</table>


	<hr width="85%" />

	<table width="85%" cellspacing="3" cellpadding="0" border="0" align="center">
	<tr>
		<td width="10%" nowrap="nowrap">Author:&nbsp;</td>
		<td><b>Splitwirez</b> [ Sun Feb 05, 2017 8:56 am ]</td>
	</tr>
	<tr>
		<td width="10%" nowrap="nowrap">Post subject:&nbsp;</td>
		<td><b>Re: Run as a Service?</b></td>
	</tr>
	<tr>
		<td colspan="2"><hr class="sep" /><div class="quotetitle">Anixx wrote:</div><div class="quotecontent"><div class="quotetitle">Ivo wrote:</div><div class="quotecontent">Yup, you are on your own <img src="images/smilies/icon_e_smile.gif" alt=":)" title="Smile" /> I can't even begin to think of what can go wrong in such scenario...</div><br /><br />Actually it is quite important thing to have a classic taskbar under Win10, and running Vista Explorer under Win10 is a solution, only if Classic Shell was working in this setup...</div><br /><br />That's literally why I asked. Vista's explorer is largely functional on 10, the only crucial piece that's missing is the Start Menu. Classic Shell could provide that...please, Ivo...we're so close...

		

		</td>
	</tr>
	</table>


<hr width="85%" />

<table width="85%" cellspacing="3" cellpadding="0" border="0" align="center">
<tr>
	<td><span class="gensmall">Page <strong>1</strong> of <strong>1</strong></span></td>
	<td align="right"><span class="gensmall">All times are UTC - 8 hours [ <abbr title="Daylight Saving Time">DST</abbr> ]</span></td>
</tr>
<tr>
	<td colspan="2" align="center"><span class="gensmall">Powered by phpBB&reg; Forum Software &copy; phpBB Group<br />https://www.phpbb.com/</span></td>
</tr>
</table>

</body>

<!-- Mirrored from www.classicshell.net/forum/viewtopic.php?f=13&t=7266&view=print by HTTrack Website Copier/3.x [XR&CO'2014], Fri, 08 Jun 2018 09:38:14 GMT -->
</html>